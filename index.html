<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#3498db">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Workout Tracker">
    <link rel="manifest" href="manifest.json">
    <title>Weekly Workout Tracker</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        
        @media (max-width: 768px) {
            .workout-grid { grid-template-columns: 1fr; }
            .exercise-table { font-size: 14px; }
            .weight-input { width: 50px; }
            .nutrition-tracker { grid-template-columns: repeat(2, 1fr); }
            .container { margin: 10px; padding: 15px; }
        }
        
        .install-prompt {
            background: #2ecc71;
            color: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            text-align: center;
            display: none;
        }
        
        .install-btn {
            background: white;
            color: #2ecc71;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            margin-left: 10px;
            cursor: pointer;
            font-weight: bold;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            border-bottom: 3px solid #3498db;
            padding-bottom: 10px;
        }
        
        .week-selector {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .week-selector select {
            padding: 8px 15px;
            font-size: 16px;
            border: 2px solid #3498db;
            border-radius: 5px;
            background: white;
        }
        
        .workout-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .workout-card {
            border: 2px solid #ecf0f1;
            border-radius: 8px;
            padding: 15px;
            background: #fafafa;
        }
        
        .workout-card.upper-a { border-left: 5px solid #e74c3c; }
        .workout-card.lower { border-left: 5px solid #f39c12; }
        .workout-card.upper-b { border-left: 5px solid #9b59b6; }
        .workout-card.cardio { border-left: 5px solid #27ae60; }
        .workout-card.rest { border-left: 5px solid #95a5a6; }
        
        .workout-title {
            font-weight: bold;
            font-size: 18px;
            margin-bottom: 15px;
            text-align: center;
            padding: 8px;
            border-radius: 5px;
            color: white;
        }
        
        .upper-a .workout-title { background: #e74c3c; }
        .lower .workout-title { background: #f39c12; }
        .upper-b .workout-title { background: #9b59b6; }
        .cardio .workout-title { background: #27ae60; }
        .rest .workout-title { background: #95a5a6; }
        
        .exercise-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        
        .exercise-table th,
        .exercise-table td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        
        .exercise-table th {
            background-color: #34495e;
            color: white;
            font-weight: bold;
        }
        
        .exercise-name {
            font-weight: bold;
            color: #2c3e50;
        }
        
        .sets-reps {
            color: #7f8c8d;
            font-weight: bold;
        }
        
        .weight-input {
            width: 60px;
            padding: 4px;
            border: 1px solid #bdc3c7;
            border-radius: 3px;
            text-align: center;
        }
        
        .completed-checkbox {
            transform: scale(1.2);
        }
        
        .notes-section {
            margin-top: 20px;
            padding: 15px;
            background: #ecf0f1;
            border-radius: 5px;
        }
        
        .notes-section h3 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }
        
        .nutrition-tracker {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 20px;
            padding: 15px;
            background: #e8f5e8;
            border-radius: 8px;
        }
        
        .nutrition-item {
            text-align: center;
        }
        
        .nutrition-item label {
            display: block;
            font-weight: bold;
            margin-bottom: 5px;
            color: #27ae60;
        }
        
        .nutrition-item input {
            width: 80px;
            padding: 5px;
            border: 2px solid #27ae60;
            border-radius: 5px;
            text-align: center;
        }
        
        .progression-notes {
            background: #fff3cd;
            border: 2px solid #ffeaa7;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .progression-notes h3 {
            color: #f39c12;
            margin: 0 0 10px 0;
        }
        
        .cues-section {
            background: #d1ecf1;
            border: 2px solid #bee5eb;
            border-radius: 8px;
            padding: 15px;
            margin: 20px 0;
        }
        
        .cues-section h3 {
            color: #0c5460;
            margin: 0 0 10px 0;
        }
        
        .cue-item {
            margin: 5px 0;
            color: #0c5460;
        }
        
        .download-btn {
            background: #3498db;
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            margin: 20px auto;
            display: block;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #ecf0f1;
            border-radius: 4px;
            margin: 10px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #27ae60, #2ecc71);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        .workout-stats {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin: 15px 0;
            text-align: center;
        }
        
        .stat-item {
            background: #f8f9fa;
            padding: 10px;
            border-radius: 5px;
            border-left: 3px solid #3498db;
        }
        
        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .stat-label {
            font-size: 12px;
            color: #7f8c8d;
        }
        
        .streak-badge {
            display: inline-block;
            background: #f39c12;
            color: white;
            padding: 4px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .sync-status {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 8px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            z-index: 1000;
            transition: all 0.3s ease;
        }
        
        .sync-success {
            background: #2ecc71;
            color: white;
        }
        
        .sync-error {
            background: #e74c3c;
            color: white;
        }
    </style>
</head>
<body>
    <div id="sync-status" class="sync-status" style="display: none;"></div>
    
    <div class="container">
        <div id="install-prompt" class="install-prompt">
            ðŸ“± Install this app on your phone for easy access!
            <button id="install-btn" class="install-btn">Install</button>
        </div>
        
        <h1>Weekly Workout Tracker <span id="streak-badge" class="streak-badge">0 week streak</span></h1>
        
        <div class="workout-stats">
            <div class="stat-item">
                <div class="stat-value" id="workouts-completed">0</div>
                <div class="stat-label">Workouts Done</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="total-volume">0</div>
                <div class="stat-label">Total Volume (kg)</div>
            </div>
            <div class="stat-item">
                <div class="stat-value" id="consistency-rate">0%</div>
                <div class="stat-label">Consistency</div>
            </div>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="week-progress"></div>
        </div>
        <p style="text-align: center; margin: 5px 0; color: #7f8c8d; font-size: 14px;">Weekly Progress</p>
        
        <div class="week-selector">
            <label for="week-select"><strong>Select Week: </strong></label>
            <select id="week-select" onchange="updateWeek()">
                <option value="1">Week 1</option>
                <option value="2">Week 2</option>
                <option value="3">Week 3</option>
                <option value="4">Week 4</option>
                <option value="5">Week 5</option>
                <option value="6">Week 6</option>
                <option value="7">Week 7 (Deload)</option>
                <option value="8">Week 8</option>
                <option value="9">Week 9</option>
                <option value="10">Week 10</option>
                <option value="11">Week 11</option>
                <option value="12">Week 12</option>
            </select>
        </div>
        
        <div class="workout-grid">
            <!-- Monday - Upper A -->
            <div class="workout-card upper-a">
                <div class="workout-title">MON - Upper A (Horizontal Bias)</div>
                <table class="exercise-table">
                    <thead>
                        <tr>
                            <th>Exercise</th>
                            <th>SetsÃ—Reps</th>
                            <th>Weight (kg)</th>
                            <th>âœ“</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="exercise-name">Barbell Bench Press</td>
                            <td class="sets-reps">3Ã—5-8</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">Chest-Supported Row</td>
                            <td class="sets-reps">3Ã—6-10</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">Incline DB Press</td>
                            <td class="sets-reps">3Ã—6-10</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">Seated Cable Row</td>
                            <td class="sets-reps">3Ã—8-12</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">Cable Lateral Raise</td>
                            <td class="sets-reps">4Ã—12-15</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">Rope Pressdown</td>
                            <td class="sets-reps">3Ã—10-15</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">Face Pulls (Optional)</td>
                            <td class="sets-reps">2Ã—15</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Tuesday - Cardio Intervals -->
            <div class="workout-card cardio">
                <div class="workout-title">TUE - Cardio (Intervals)</div>
                <div style="padding: 10px;">
                    <p><strong>Equipment:</strong> <select><option>Treadmill</option><option>Bike</option><option>Rower</option></select></p>
                    <div id="interval-protocol">
                        <p><strong>Week 1-2:</strong> 6Ã—2min hard @ RPE 8-9, 2min easy</p>
                        <p><strong>Week 3-6:</strong> 5Ã—3min hard, 2min easy</p>
                        <p><strong>Week 8-12:</strong> 4Ã—4min hard, 2min easy</p>
                    </div>
                    <p><strong>Total Time:</strong> <input type="number" style="width: 60px;"> minutes</p>
                    <p><strong>Average HR:</strong> <input type="number" style="width: 60px;"> bpm</p>
                    <p><strong>RPE:</strong> <input type="number" min="1" max="10" style="width: 60px;"> /10</p>
                    <p><strong>Completed:</strong> <input type="checkbox" class="completed-checkbox"></p>
                </div>
            </div>
            
            <!-- Wednesday - Lower -->
            <div class="workout-card lower">
                <div class="workout-title">WED - Lower + Core</div>
                <table class="exercise-table">
                    <thead>
                        <tr>
                            <th>Exercise</th>
                            <th>SetsÃ—Reps</th>
                            <th>Weight (kg)</th>
                            <th>âœ“</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="exercise-name">Back/Hack Squat</td>
                            <td class="sets-reps">4Ã—5-8</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">Romanian Deadlift</td>
                            <td class="sets-reps">3Ã—6-10</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">Bulgarian Split Squat</td>
                            <td class="sets-reps">3Ã—8-12/leg</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">Leg Curl</td>
                            <td class="sets-reps">3Ã—10-15</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">Cable Crunch</td>
                            <td class="sets-reps">3Ã—12-15</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">Side Plank</td>
                            <td class="sets-reps">2Ã—45-60s/side</td>
                            <td>Bodyweight</td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Thursday - Rest -->
            <div class="workout-card rest">
                <div class="workout-title">THU - Rest Day</div>
                <div style="padding: 20px; text-align: center;">
                    <p><strong>Target:</strong> 8,000-10,000 steps</p>
                    <p><strong>Steps Today:</strong> <input type="number" style="width: 80px;"> steps</p>
                    <p><strong>Sleep Quality:</strong> 
                        <select>
                            <option>Poor</option>
                            <option>Fair</option>
                            <option>Good</option>
                            <option>Excellent</option>
                        </select>
                    </p>
                    <p><strong>Recovery Notes:</strong></p>
                    <textarea style="width: 100%; height: 60px; resize: vertical;"></textarea>
                </div>
            </div>
            
            <!-- Friday - Upper B -->
            <div class="workout-card upper-b">
                <div class="workout-title">FRI - Upper B (Vertical Bias)</div>
                <table class="exercise-table">
                    <thead>
                        <tr>
                            <th>Exercise</th>
                            <th>SetsÃ—Reps</th>
                            <th>Weight (kg)</th>
                            <th>âœ“</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td class="exercise-name">Weighted Pull-up/Lat Pulldown</td>
                            <td class="sets-reps">4Ã—6-10</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">Overhead Press</td>
                            <td class="sets-reps">3Ã—5-8</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">Flat DB Press</td>
                            <td class="sets-reps">3Ã—6-10</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">Chest-Supported Row</td>
                            <td class="sets-reps">3Ã—6-10</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">Cable Lateral Raise</td>
                            <td class="sets-reps">3Ã—12-15</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">DB Hammer Curl</td>
                            <td class="sets-reps">3Ã—8-12</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                        <tr>
                            <td class="exercise-name">Overhead Cable Triceps</td>
                            <td class="sets-reps">3Ã—8-12</td>
                            <td><input type="number" class="weight-input" placeholder="kg"></td>
                            <td><input type="checkbox" class="completed-checkbox"></td>
                        </tr>
                    </tbody>
                </table>
            </div>
            
            <!-- Saturday - Zone 2 Cardio -->
            <div class="workout-card cardio">
                <div class="workout-title">SAT - Zone 2 Cardio</div>
                <div style="padding: 10px;">
                    <p><strong>Duration:</strong> 35-50 minutes</p>
                    <p><strong>Target HR:</strong> 60-70% HRmax (conversational pace)</p>
                    <p><strong>Equipment:</strong> <select><option>Treadmill (6-10% incline)</option><option>Bike (70-85 rpm)</option></select></p>
                    <p><strong>Time Completed:</strong> <input type="number" style="width: 60px;"> minutes</p>
                    <p><strong>Average HR:</strong> <input type="number" style="width: 60px;"> bpm</p>
                    <p><strong>Could hold conversation:</strong> <input type="checkbox"></p>
                    <p><strong>Completed:</strong> <input type="checkbox" class="completed-checkbox"></p>
                    <p><em>Add 5min every 2 weeks up to 50min</em></p>
                </div>
            </div>
            
            <!-- Sunday - Rest -->
            <div class="workout-card rest">
                <div class="workout-title">SUN - Rest Day</div>
                <div style="padding: 20px; text-align: center;">
                    <p><strong>Target:</strong> 8,000-10,000 steps</p>
                    <p><strong>Steps Today:</strong> <input type="number" style="width: 80px;"> steps</p>
                    <p><strong>Weekly Reflection:</strong></p>
                    <textarea style="width: 100%; height: 80px; resize: vertical;" placeholder="How did this week go? Any adjustments needed?"></textarea>
                </div>
            </div>
        </div>
        
        <!-- Nutrition Tracker -->
        <div class="nutrition-tracker">
            <h3 style="grid-column: 1/-1; text-align: center; margin: 0 0 15px 0; color: #27ae60;">Daily Nutrition Targets</h3>
            <div class="nutrition-item">
                <label>Calories (Training)</label>
                <input type="number" placeholder="2100">
            </div>
            <div class="nutrition-item">
                <label>Calories (Rest)</label>
                <input type="number" placeholder="1800">
            </div>
            <div class="nutrition-item">
                <label>Protein (g)</label>
                <input type="number" placeholder="160">
            </div>
            <div class="nutrition-item">
                <label>Water (L)</label>
                <input type="number" step="0.1" placeholder="3.0">
            </div>
        </div>
        
        <!-- Progression Notes -->
        <div class="progression-notes">
            <h3>Progression Protocol</h3>
            <p><strong>Target:</strong> 1-2 RIR (Reps in Reserve) on all lifts</p>
            <p><strong>Double Progression:</strong> Hit top of rep range on all sets â†’ add 2.5-5kg next session</p>
            <p><strong>Deload Week 7:</strong> Reduce load by 10-15% OR perform half the sets</p>
            <p><strong>Warm-up:</strong> 5-8min easy cardio + 2 ramp sets for first two exercises</p>
        </div>
        
        <!-- Form Cues -->
        <div class="cues-section">
            <h3>Form Cues (Quick Reference)</h3>
            <div class="cue-item"><strong>Rows/Pulldowns:</strong> Chest up, elbows to hips, 2-sec squeeze, 3-sec down</div>
            <div class="cue-item"><strong>Squat:</strong> Brace core, sit between feet, full foot pressure</div>
            <div class="cue-item"><strong>RDL:</strong> Hip hinge, soft knees, lats tight, mid-shin depth</div>
            <div class="cue-item"><strong>Presses:</strong> Scapula back/down, bar over mid-foot (OHP)</div>
        </div>
        
        <!-- Notes Section -->
        <div class="notes-section">
            <h3>Weekly Notes & Observations</h3>
            <textarea style="width: 100%; height: 100px; border: 1px solid #bdc3c7; border-radius: 5px; padding: 10px; resize: vertical;" placeholder="Track your progress, how you're feeling, any form improvements, energy levels, etc."></textarea>
        </div>
        
        <button class="download-btn" onclick="exportToSheets()" style="background: #27ae60;">Export to Sheets</button>
    </div>
    
    <script>
        // REPLACE THIS WITH YOUR NEW APPS SCRIPT URL
        const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxBQs4-RhWOW28fyjJ5lWBqmP0BkYO1fA_JiAge-IRww96nMfWIf2fNoXn9UWqxueE/exec';
        
        function showSyncStatus(message, isSuccess = true) {
            const status = document.getElementById('sync-status');
            status.textContent = message;
            status.className = 'sync-status ' + (isSuccess ? 'sync-success' : 'sync-error');
            status.style.display = 'block';
            setTimeout(() => {
                status.style.display = 'none';
            }, 3000);
        }
        
        function syncToSheets(exercise, weight, completed) {
            if (GOOGLE_SCRIPT_URL === 'PUT_YOUR_NEW_APPS_SCRIPT_URL_HERE') {
                showSyncStatus('Update Apps Script URL', false);
                return;
            }
            
            const week = document.getElementById('week-select').value;
            const data = {
                week: week,
                day: exercise.includes('Bench') || exercise.includes('Row') || exercise.includes('Incline') || exercise.includes('Lateral') || exercise.includes('Pressdown') || exercise.includes('Face') ? 'Monday' :
                     exercise.includes('Squat') || exercise.includes('Deadlift') || exercise.includes('Bulgarian') || exercise.includes('Leg') || exercise.includes('Crunch') || exercise.includes('Plank') ? 'Wednesday' : 'Friday',
                exercise: exercise,
                weight: weight || 0,
                completed: completed ? 'Yes' : 'No'
            };
            
            fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (response.ok) {
                    showSyncStatus('âœ“ Synced', true);
                    return response.text();
                } else {
                    throw new Error('Sync failed');
                }
            })
            .catch(err => {
                showSyncStatus('âœ— Sync failed', false);
                console.log('Sync error:', err);
            });
        }
        
        function updateWeek() {
            const week = document.getElementById('week-select').value;
            const intervalProtocol = document.getElementById('interval-protocol');
            
            if (week <= 2) {
                intervalProtocol.innerHTML = '<p><strong>Current Protocol:</strong> 6Ã—2min hard @ RPE 8-9, 2min easy</p>';
            } else if (week <= 6) {
                intervalProtocol.innerHTML = '<p><strong>Current Protocol:</strong> 5Ã—3min hard, 2min easy</p>';
            } else if (week == 7) {
                intervalProtocol.innerHTML = '<p><strong>Deload Week:</strong> 4Ã—2min easy @ RPE 6-7, 2min easy</p>';
            } else {
                intervalProtocol.innerHTML = '
intervalProtocol.innerHTML = '<p><strong>Current Protocol:</strong> 4Ã—4min hard, 2min easy</p>';
            }
        }
        
        function exportToSheets() {
            const week = document.getElementById('week-select').value;
            const data = [];
            
            data.push(['Week', 'Day', 'Exercise', 'Weight_kg', 'Completed', 'Notes']);
            
            const workouts = [
                { day: 'Monday', exercises: ['Barbell Bench Press', 'Chest-Supported Row', 'Incline DB Press', 'Seated Cable Row', 'Cable Lateral Raise', 'Rope Pressdown', 'Face Pulls (Optional)'] },
                { day: 'Wednesday', exercises: ['Back/Hack Squat', 'Romanian Deadlift', 'Bulgarian Split Squat', 'Leg Curl', 'Cable Crunch', 'Side Plank'] },
                { day: 'Friday', exercises: ['Weighted Pull-up/Lat Pulldown', 'Overhead Press', 'Flat DB Press', 'Chest-Supported Row', 'Cable Lateral Raise', 'DB Hammer Curl', 'Overhead Cable Triceps'] }
            ];
            
            const weightInputs = document.querySelectorAll('.weight-input');
            const checkboxes = document.querySelectorAll('.completed-checkbox');
            let inputIndex = 0;
            
            workouts.forEach(workout => {
                workout.exercises.forEach(exercise => {
                    const weight = weightInputs[inputIndex]?.value || '';
                    const completed = checkboxes[inputIndex]?.checked ? 'Yes' : 'No';
                    data.push([week, workout.day, exercise, weight, completed, '']);
                    inputIndex++;
                });
            });
            
            const csv = data.map(row => row.map(cell => `"${cell}"`).join(',')).join('\n');
            const blob = new Blob([csv], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `workout-week-${week}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showSyncStatus('CSV Downloaded', true);
        }
        
        function saveData() {
            const inputs = document.querySelectorAll('input, select, textarea');
            const data = {};
            inputs.forEach((input, index) => {
                if (input.type === 'checkbox') {
                    data[index] = input.checked;
                } else {
                    data[index] = input.value;
                }
            });
            localStorage.setItem('workoutData', JSON.stringify(data));
        }
        
        function loadData() {
            const data = localStorage.getItem('workoutData');
            if (data) {
                const parsedData = JSON.parse(data);
                const inputs = document.querySelectorAll('input, select, textarea');
                inputs.forEach((input, index) => {
                    if (parsedData[index] !== undefined) {
                        if (input.type === 'checkbox') {
                            input.checked = parsedData[index];
                        } else {
                            input.value = parsedData[index];
                        }
                    }
                });
            }
        }
        
        function addSyncListeners() {
            const exercises = [
                'Barbell Bench Press', 'Chest-Supported Row', 'Incline DB Press', 'Seated Cable Row', 'Cable Lateral Raise', 'Rope Pressdown', 'Face Pulls (Optional)',
                'Back/Hack Squat', 'Romanian Deadlift', 'Bulgarian Split Squat', 'Leg Curl', 'Cable Crunch', 'Side Plank',
                'Weighted Pull-up/Lat Pulldown', 'Overhead Press', 'Flat DB Press', 'Chest-Supported Row', 'Cable Lateral Raise', 'DB Hammer Curl', 'Overhead Cable Triceps'
            ];
            
            const weightInputs = document.querySelectorAll('.weight-input');
            const checkboxes = document.querySelectorAll('.completed-checkbox');
            
            weightInputs.forEach((input, index) => {
                if (exercises[index] && index < exercises.length) {
                    input.addEventListener('change', () => {
                        const checkbox = checkboxes[index];
                        syncToSheets(exercises[index], input.value, checkbox?.checked);
                    });
                }
            });
            
            checkboxes.forEach((checkbox, index) => {
                if (exercises[index] && index < exercises.length) {
                    checkbox.addEventListener('change', () => {
                        const weightInput = weightInputs[index];
                        syncToSheets(exercises[index], weightInput?.value, checkbox.checked);
                    });
                }
            });
        }
        
        function updateProgress() {
            const checkboxes = document.querySelectorAll('.completed-checkbox');
            const weights = document.querySelectorAll('.weight-input');
            
            let completed = 0;
            let totalVolume = 0;
            let totalExercises = checkboxes.length;
            
            checkboxes.forEach((checkbox, index) => {
                if (checkbox.checked) {
                    completed++;
                    const weight = parseFloat(weights[index]?.value) || 0;
                    totalVolume += weight * 10;
                }
            });
            
            const progressPercent = totalExercises > 0 ? (completed / totalExercises) * 100 : 0;
            const consistencyRate = Math.round(progressPercent);
            
            document.getElementById('workouts-completed').textContent = completed;
            document.getElementById('total-volume').textContent = Math.round(totalVolume);
            document.getElementById('consistency-rate').textContent = consistencyRate + '%';
            document.getElementById('week-progress').style.width = progressPercent + '%';
            
            const currentWeek = document.getElementById('week-select').value;
            const streak = Math.max(0, parseInt(currentWeek) - 1);
            document.getElementById('streak-badge').textContent = streak + ' week streak';
        }
        
        // PWA Installation
        let deferredPrompt;
        const installPrompt = document.getElementById('install-prompt');
        const installBtn = document.getElementById('install-btn');
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installPrompt.style.display = 'block';
        });
        
        installBtn.addEventListener('click', async () => {
            if (deferredPrompt) {
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                deferredPrompt = null;
                installPrompt.style.display = 'none';
            }
        });
        
        window.addEventListener('appinstalled', () => {
            installPrompt.style.display = 'none';
        });
        
        // Initialize everything
        updateWeek();
        
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            updateProgress();
            addSyncListeners();
        });
        
        document.addEventListener('input', function() {
            saveData();
            updateProgress();
        });
        
        document.addEventListener('change', function() {
            saveData();
            updateProgress();
        });
    </script>
</body>
</html>
